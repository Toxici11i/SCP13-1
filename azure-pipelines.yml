pool:
  vmImage: "ubuntu-16.04"

steps:

- script: docker login docker.io -u looreydev -p $(dockerPassword)
  displayName: "login to docker.io"

- task: Docker@2
  displayName: "build container"
  inputs:
    containerRegistry: 'docker'
    repository: 'ss13-scp13'
    command: 'build'
    Dockerfile: '**/Dockerfile'

- script: docker push looreydev/ss13-scp13:latest
  displayName: "push container"

- script: docker logout
  displayName: "log out of docker"

- task: ado-discord-webhook@1
  displayName: "report status to discord"
  inputs:
    channelId: '$(discordChanId)'
    webhookKey: '$(discordWebhookUri)'
    name: 'Azure'
    avatar: 'https://avatars.slack-edge.com/2019-01-17/528389819366_e7a0672f0480b3e98d21_512.png'
    messageType: 'embeds'